name: Update & Validate EVM Chains Data

on:
  schedule:
    - cron: '0 * * * *'  # ØªØ´ØºÙŠÙ„ ÙƒÙ„ Ø³Ø§Ø¹Ø©
  workflow_dispatch:  # Ø¯Ø¹Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ

jobs:
  update-chains:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ”„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
        uses: actions/checkout@v4

      - name: âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
        run: |
          pip install -r requirements.txt

      - name: ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„ØªØ­Ù‚Ù‚
        run: python script.py

      - name: ğŸ“ Ø±ÙØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add chains.json
          git commit -m "ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ§Øª $(date +'%Y-%m-%d %H:%M:%S')" || echo "No changes to commit"
          git push

      - name: ğŸ“¢ Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰ Discord
        if: always()
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{"content": "ğŸš€ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ§Øª Ù†Ø§Ø¬Ø­! âœ…"}' \
               ${{ secrets.DISCORD_WEBHOOK }}
